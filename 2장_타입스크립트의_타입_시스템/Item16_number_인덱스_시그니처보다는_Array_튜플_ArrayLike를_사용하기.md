## 📕 오늘 읽은 내용, 이런 식으로 정리해 봅시다. ✒

**TIL(Today I learn) 기록일** : 2022.01.22

**오늘 읽은 범위** : 16. number 인덱스 시그니처보다는 Array, 튜플, ArrayLike를 사용하기


# Item 16. number 인덱스 시그니처보다는 Array, 튜플, ArrayLike를 사용하기
자바스크립트는 이상하게 동작하기로 유명한 언어이다.   
그중 가장 악명 높은 것은 암시적 타입 강제와 관련된 부분입니다.   
  
```ts
"0" == 0
true
```

다행히도 암시적 타입 강제와 관련된 문제는 대부분 ===와 !==를 사용해서 해결이 가능합니다.   
  
자바스크립트 객체 모델에도 이상한 부분들이 있으며, 이 중 일부는 타입스크립트 타입 시스템으로 모델링되기 때문에 자바스크립트 객체 모델을 이해하는 것이 중요하다.   
이미 아이템 10에서 다룬 객체 래퍼 타입에서 이러한 이상한 특징을 살펴보았다.   
   
 이번 아이템에서는 또 다른 이상한 점들을 다룬다.   
     
 자바스립트에서 객체란 키/값 쌍의 모음이다.   
 키는 보통 문자열이다.(ES2015 이후로는 심벌일 수 있다.)   
 그리고 값은 어떤 것이든 될 수 있다.   
    
파이썬이나 자바에서 볼 수 있는 '해시 가능'객체라는 표현이 자바스크립트에는 없다.   
만약 더 복잡한 객체를 키로 사용하려고 하면, toString메서드가 호출되어 객체가 문자열로 변환된다.   
```ts
> x = {}
{}
> x[[1, 2, 3]] = 2
2
> x
{'1,2,3' : 1}
```

>특히, 숫자는 키로 사용할 수 없다. 만약 속성 이름으로 숫자를 사용하려고하면, 자바스크립트 런타임은 문자열로 변환할 겁니다.   
```ts
>{1: 2, 3: 4 }
{ "1" : 2, "3" : 4 }
```
> 이번엔 배열을 알아보겠다. 배열은 분명히 객체이다.
```ts
>typeof []
'object'
```
> 그러니 숫자 인덱스를 사용하는 것이 당연하다.
```ts
> x = [1, 2, 3]
[1, 2, 3]
> x[0]
1
```

이상하게 보일지 모르지만, 앞의 인덱스들은 문자열로 변환되어 사용된다.   
문자열 키를 사용해도 역시 배열의 요소에 접근할 수 있다.   
```ts
>x['1']
2
```

>Object.keys를 이용해 배열의 키를 나열해 보면, 키가 문자열로 출력된다.
```ts
>Object.keys(x)
[ '0', '1', '2']
```

타입스크립트는 이러한 혼란을 바로잡기 위해 숫자 키를 허용하고, 문자열 키와 다른 것으로 인식한다.   
Array에 대한 타입 선언은, lib.es5.d.ts에서 확인할 수 있다.
```ts
interface Array<T> {
  // ....
  [n: number] : T;
}
```
>런타임에는 ECMAScript 표준이 서술하는 것처럼 문자열 키로 인식하므로 이 코드는 완전히 가상이라고 할 수 있지만 타입 체크 시점에 오류를 잡을 수 있어 유용하다.   
```ts
const xs = [1, 2, 3];
const x0 = xs[0];  // OK
const x1 = xs['1'];
           // ~~~ Element implicitly has an 'any' type
           //      because index expression is not of type 'number'

function get<T>(array: T[], k: string): T {
  return array[k];
            // ~ Element implicitly has an 'any' type
            //   because index expression is not of type 'number'
}
``` 
다시 한번 다시 말하지만, 이코드는 실제로 동작하지 않습니다.   
그리고 타입스크립트 타입 시스템의 다른 것들과 마찬가지로, 타입 정보는 런타임에 제거된다.   
> 한편 Object.keys 같은 구문은 여전히 문자열로 반환된다.
```ts
const xs = [1, 2, 3];
const keys = Object.keys(xs);  // Type is string[]
for (const key in xs) {
  key;  // Type is string
  const x = xs[key];  // Type is number
}
```
string이 number에 할당될 수 없기 때문에, 예제의 마지막 줄이 동작하는 것이 이상하게 보일 것이다.   
배열을 순회하는 코드 스타일에 대한 실용적인 허용이라고 생각하면 좋다.   
자바스크립트에서는 흔한 일이지만, 이 예제가 배열을 순횐하기에 좋은 방법은 아니다.   
인덱스에 신경 쓰지 않는다면, for-of를 사용하는 게 더 좋다.   
   
 만약 인덱스의 타입이 중요하다면, number 타입을 제공해 줄 Array.prototype, forEach를 사용하면 된다.
